---
title: EM ç®—æ³•
categories: [Statistics]
comments: true
---

## ä»‹ç»EMç®—æ³•

EMç®—æ³•æ˜¯åŸºäºéšå˜é‡æ€æƒ³æå‡ºçš„ä¸€ç§ç®—æ³•ã€‚

+ é¦–å…ˆæ ¹æ®å·±ç»ç»™å‡ºçš„è§‚æµ‹æ•°æ®ï¼Œä¼°è®¡å‡ºæ¨¡å‹å‚æ•°çš„å€¼ï¼›
+ ç„¶åå†ä¾æ®ä¸Šä¸€æ­¥ä¼°è®¡å‡ºçš„å‚æ•°å€¼ä¼°è®¡ç¼ºå¤±æ•°æ®çš„å€¼ï¼›
+ å†æ ¹æ®ä¼°è®¡å‡ºçš„ç¼ºå¤±æ•°æ®åŠ ä¸Šä¹‹å‰å·±ç»è§‚æµ‹åˆ°çš„æ•°æ®é‡æ–°å†å¯¹å‚æ•°å€¼è¿›è¡Œä¼°è®¡ã€‚
+ ç„¶ååå¤è¿­ä»£ï¼Œç›´è‡³æœ€åæ”¶æ•›ï¼Œè¿­ä»£ç»“æŸã€‚


## å‰ç½®çŸ¥è¯†

+ æå¤§ä¼¼ç„¶ä¼°è®¡
+ Jensenä¸ç­‰å¼

$$f(E(x))\le E(f(x))$$

## ä¾‹å­ï¼šç”·å¥³ç”Ÿèº«é«˜åˆ†å¸ƒ

æˆ‘ä»¬ç›®å‰æœ‰100ä¸ªç”·ç”Ÿå’Œ100ä¸ªå¥³ç”Ÿçš„èº«é«˜ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“è¿™200ä¸ªæ•°æ®ä¸­å“ªä¸ªæ˜¯ç”·ç”Ÿçš„èº«é«˜ï¼Œå“ªä¸ªæ˜¯å¥³ç”Ÿçš„èº«é«˜ï¼Œå³æŠ½å–å¾—åˆ°çš„æ¯ä¸ªæ ·æœ¬éƒ½ä¸çŸ¥é“æ˜¯ä»å“ªä¸ªåˆ†å¸ƒä¸­æŠ½å–çš„ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¯¹äºæ¯ä¸ªæ ·æœ¬ï¼Œå°±æœ‰ä¸¤ä¸ªæœªçŸ¥é‡éœ€è¦ä¼°è®¡ï¼š
+ ï¼ˆ1ï¼‰è¿™ä¸ªèº«é«˜æ•°æ®æ˜¯æ¥è‡ªäºç”·ç”Ÿæ•°æ®é›†åˆè¿˜æ˜¯æ¥è‡ªäºå¥³ç”Ÿï¼Ÿ
+ ï¼ˆ2ï¼‰ç”·ç”Ÿã€å¥³ç”Ÿèº«é«˜æ•°æ®é›†çš„æ­£æ€åˆ†å¸ƒçš„å‚æ•°åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ

### é—®é¢˜æ¡ä»¶

å·²çŸ¥ï¼š
+ ï¼ˆ1ï¼‰åˆ†å¸ƒæ¨¡å‹
+ ï¼ˆ2ï¼‰éšæœºæŠ½å–çš„æ ·æœ¬

æœªçŸ¥ï¼š
+ ï¼ˆ1ï¼‰æ¯ä¸€ä¸ªæ ·æœ¬å±äºå“ªä¸ªåˆ†å¸ƒ
+ ï¼ˆ2ï¼‰åˆ†å¸ƒçš„å…·ä½“å‚æ•°

### ç®—æ³•æµç¨‹

ï¼ˆ1ï¼‰åˆå§‹åŒ–æ¨¡å‹å‚æ•°

ï¼ˆ2ï¼‰è®¡ç®—æ¯ä¸€ä¸ªæ ·æœ¬æ¥è‡ªç”·ç”Ÿåˆ†å¸ƒæˆ–æ˜¯å¥³ç”Ÿåˆ†å¸ƒ

ï¼ˆ3ï¼‰é€šè¿‡ï¼ˆ2ï¼‰ä¸­å±äºç”·ç”Ÿåˆ†å¸ƒçš„æ ·æœ¬æ¥é‡æ–°ä¼°è®¡ç”·ç”Ÿåˆ†å¸ƒçš„å‚æ•°ï¼ˆæå¤§ä¼¼ç„¶ä¼°è®¡ï¼‰ï¼Œå¥³ç”Ÿåˆ†å¸ƒåŒç†ã€‚

ï¼ˆ4ï¼‰é‡å¤ï¼ˆ1ï¼‰-ï¼ˆ3ï¼‰æ­¥éª¤ï¼Œç›´åˆ°å‚æ•°ä¸å‘ç”Ÿå˜åŒ–ï¼Œè¿­ä»£ç»ˆæ­¢ã€‚

## EMç®—æ³•æ¨å¯¼è¿‡ç¨‹

+ ï¼ˆ1ï¼‰æ±‚æ ·æœ¬çš„å¯¹æ•°ä¼¼ç„¶å‡½æ•°ï¼š

$$
l(\theta)=\log \prod_{i} p\left(x_{i} ; \theta\right)=\sum_{i} \log p\left(x_{i} ; \theta\right)
$$

+ (2)æå¤§ä¼¼ç„¶ä¼°è®¡å¾—åˆ°å‚æ•°ï¼š

$$
\hat{\theta}=\operatorname{argmax} l(\theta)=\operatorname{argmax} \sum_{i} \log \sum_{z_{i}} p\left(x_{i}, z_{i} ; \theta\right)
$$

+ ï¼ˆ3ï¼‰ç”±äº$ğ‘(ğ‘¥_ğ‘–,ğ‘§_ğ‘–;\theta)$ä¸èƒ½ç›´æ¥å¾—åˆ°ï¼Œæ•…æ¥ä¸‹æ¥åˆ©ç”¨Jensenä¸ç­‰å¼æ¥æ‰¾åˆ°å®ƒçš„é€¼è¿‘ã€‚

+ (4) åˆ©ç”¨Jensenä¸ç­‰å¼ç¼©æ”¾ä¸Šå¼ï¼Œå…¶ä¸­$ğ‘„_ğ‘– (ğ‘§_ğ‘– )$ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼š

$$\sum_{i} \log \sum_{z_{i}} p\left(x_{i}, z_{i} ; \theta\right)= \sum_{i} \log \sum_{z_{i}} Q_{i}\left(z_{i}\right) \frac{p\left(x_{i}, z_{i} ; \theta\right)}{Q_{i}\left(z_{i}\right)}$$

$$\geq \sum_{i} \sum_{z_{i}} Q_{i}(z_{i}) \log \frac{p(x_{i}, z_{i} ; \theta)}{Q_{i}(z_{i})}$$

+ ï¼ˆ5ï¼‰ç”±ä¸ç­‰å¼æˆç«‹çš„æ¡ä»¶ï¼Œ$\sum_{i} \log \sum_{z_{i}} Q_{i}\left(z_{i}\right) \frac{p\left(x_{i}, z_{i} ; \theta\right)}{Q_{i}\left(z_{i}\right)}$ä¸º$l(\theta)$çš„ä¸‹ç•Œï¼Œæ•…æ”¹å˜$ğ‘„_ğ‘– (ğ‘§_ğ‘– )$çš„åˆ†å¸ƒï¼Œå¯ä»¥ä½¿å¾—$\sum_{i} \log \sum_{z_{i}} Q_{i}\left(z_{i}\right) \frac{p\left(x_{i}, z_{i} ; \theta\right)}{Q_{i}\left(z_{i}\right)}$çš„ç»“æœç­‰äº$l(\theta)$

+ (6)ç”±äºJensenä¸ç­‰å¼è¦å–ç­‰çš„æ¡ä»¶æ˜¯:

$$\frac{p\left(x_{i}, z_{i} ; \theta\right)}{Q_{i}\left(z_{i}\right)}=C$$

å…¶ä¸­ï¼Œcä¸ºå¸¸æ•°
+ ï¼ˆ7ï¼‰åˆç”±äº $Q_{i}\left(z_{i}\right)$ ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼Œæ•…æ»¡è¶³ï¼š $\sum_{i} Q_{i}\left(z_{i}\right)=1$, åˆ™ $\sum_{z} p\left(x_{i}, z_{i} ; \theta\right)=c$ï¼Œæ•…: 

$$Q_{i}\left(z_{i}\right)=\frac{p\left(x_{i}, z_{i} ; \theta\right)}{\sum_{z} p\left(x_{i}, z_{i} ; \theta\right)}=\frac{p\left(x_{i}, z_{i} ; \theta\right)}{p\left(x_{i} ; \theta\right)}=p\left(z_{i} \mid x_{i} ; \theta\right)$$

+ (8)ç»¼ä¸Šæ‰€è¿°: 

$$\hat{\theta}=argmax \sum_{i} \sum_{z_{i}} Q_{i}\left(z_{i}\right) \log \frac{p\left(x_{i}, z_{i} ;\theta\right)}{Q_{i}\left(z_{i}\right)}$$

å…¶ä¸­: $\quad Q_{i}\left(z_{i}\right)=p\left(z_{i} \mid x_{i} ; \theta\right)$

## ç®—æ³•æµç¨‹


è¾“å…¥ï¼š
+ æ•°æ®$x=(x_1,x_2,â€¦,x_n)$,
+ è”åˆåˆ†å¸ƒ$ğ‘(x,z;\theta)$ï¼Œ
+ æ¡ä»¶åˆ†å¸ƒ$ğ‘(z \mid x,\theta)$ï¼Œ
+ æœ€å¤§è¿­ä»£æ¬¡æ•°Jã€‚

åˆå§‹åŒ–ï¼š
+ éšæœºåˆå§‹åŒ–æ¨¡å‹å‚æ•°$\theta$ä¸º$\theta_0$
+ $j=1,2,\dots,J$å¼€å§‹è¿­ä»£ï¼š
+ - Eæ­¥ï¼šè®¡ç®—è”åˆåˆ†å¸ƒçš„æ¡ä»¶æ¦‚ç‡æœŸæœ›

$$Q_{i}\left(z_{i}\right)=p\left(z_{i} \mid x_{i} ; \theta\right)$$

$$l\left(\theta, \theta_{j}\right)=\sum_{i} \sum_{z_{i}} Q_{i}\left(z_{i}\right) \log \frac{p\left(x_{i}, z_{i} ; \theta\right)}{Q_{i}\left(z_{i}\right)}$$

+ + Mæ­¥ï¼šæå¤§åŒ– $l\left(\theta, \theta_{j}\right), \quad$ å¾—åˆ° $\theta_{j+1}$

$$\theta_{j+1}=\operatorname{argmax} l\left(\theta, \theta_{j}\right)$$

è¾“å‡ºï¼šæ¨¡å‹å‚æ•°$\theta$
